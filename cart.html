<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <script type="text/javascript">
    if (localStorage.userid!=="judy" || sessionStorage.pwd!== "123") {
      alert("Error")
      sessionStorage.removeItem("pwd");
      document.location = shoppingcart.html;
    }
    function isLoad(){
      document.getElementById("showUserId").innerHTML = localStorage.userid;
      var div_list = "";
      var sale_item = new Array("apple","grape","lemon");
      for(i in sale_item){
        div_list = div_list + "<div class='fruit'>"
        div_list = div_list + "<font style='color:##ff0000'>" + sale_item[i] + "</font><br />"
        div_list = div_list + "<input type='checkbox' name='chkitem' >"
        div_list = div_list + "我要选购</div>"
      }
      document.getElementById("div_sale").insertAdjacentHTML("beforeend", div_list);

      if(localStorage.Cartlist){
        shopping_list.value = "你的购物列表：" + localStorage.Cartlist;
      } else {
        shopping_list.value = "你的购物列表：" ;
      }

      clearButton.addEventListener("click", clearButton);
      putIntoCart.addEventListener("click", addToCart);
    }
    // clear cart
    function clearCart(){
      shopping_list.value = "你的购买列表：";
      localStorage.removeItem("Cartlist")
    }
    // add to cart
    function addToCart(){
      var checkselect = "";
      var checkBoxList = document.getElementByName("chkitem");
      for(i in checkBoxList){
        if(checkBoxList[i].checked){
          checkselect = checkselect + "\n" + checkBoxList[i].value
        }
      }
      if(!localStorage.Cartlist){
        localStorage.Cartlist = checkselect;
      } else {
        localStorage.Cartlist = localStorage.Cartlist + checkselect;
        shopping_list.value = "你的购买列表：" + localStorage.Cartlist;
      }
    }

    function logout(){
      localStorage.removeItem('userid');
      sessionStorage.clear();
      document.location = "shoppingcart.html";
    }
    </script>
  </head>

  <body onload="isLoad()">
    <div id="main">
      <header>欢迎光临水果网<input type="button" value="注销" onclick="logout()"></header>
      <span id="showUserId">aaa</span>你好，请选择要购买的水果
      <button id="clearButton">清空购物车</button>
      <button id="putIntoCart">放入购物车</button>
      <textarea id="shoppingList" rows="15" cols="30"></textarea>
      <div id="div_sale"></div>
    </div>
    <footer>
      Time: 8:30--20:30
      Tel: 123-45678
    </footer>
  </body>
  </html>
